Edited from AlbertTheTerrible's work